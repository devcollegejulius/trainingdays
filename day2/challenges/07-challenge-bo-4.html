<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>💎 Breakout 4 (optional): Create the infrastructure for our sample app with ARM templates 💎 | Azure Developer College</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/trainingdays/assets/css/0.styles.68745622.css" as="style"><link rel="preload" href="/trainingdays/assets/js/app.cdb870d0.js" as="script"><link rel="preload" href="/trainingdays/assets/js/3.bac66e4c.js" as="script"><link rel="preload" href="/trainingdays/assets/js/60.cf52ab3d.js" as="script"><link rel="prefetch" href="/trainingdays/assets/js/10.e245022a.js"><link rel="prefetch" href="/trainingdays/assets/js/11.e575ca81.js"><link rel="prefetch" href="/trainingdays/assets/js/12.4af6743d.js"><link rel="prefetch" href="/trainingdays/assets/js/13.0b26a6a5.js"><link rel="prefetch" href="/trainingdays/assets/js/14.2d92fef8.js"><link rel="prefetch" href="/trainingdays/assets/js/15.a191ca69.js"><link rel="prefetch" href="/trainingdays/assets/js/16.405c54e2.js"><link rel="prefetch" href="/trainingdays/assets/js/17.43731ef2.js"><link rel="prefetch" href="/trainingdays/assets/js/18.bd3bc7b3.js"><link rel="prefetch" href="/trainingdays/assets/js/19.a9d0edc3.js"><link rel="prefetch" href="/trainingdays/assets/js/2.0be5b509.js"><link rel="prefetch" href="/trainingdays/assets/js/20.7cffd4b4.js"><link rel="prefetch" href="/trainingdays/assets/js/21.e7fe4a64.js"><link rel="prefetch" href="/trainingdays/assets/js/22.9b14db9d.js"><link rel="prefetch" href="/trainingdays/assets/js/23.441bbca6.js"><link rel="prefetch" href="/trainingdays/assets/js/24.9c4549d9.js"><link rel="prefetch" href="/trainingdays/assets/js/25.5746a249.js"><link rel="prefetch" href="/trainingdays/assets/js/26.b54d0910.js"><link rel="prefetch" href="/trainingdays/assets/js/27.17fc5e8f.js"><link rel="prefetch" href="/trainingdays/assets/js/28.dc06e268.js"><link rel="prefetch" href="/trainingdays/assets/js/29.2c678e32.js"><link rel="prefetch" href="/trainingdays/assets/js/30.da2d71da.js"><link rel="prefetch" href="/trainingdays/assets/js/31.2d6231d3.js"><link rel="prefetch" href="/trainingdays/assets/js/32.de802251.js"><link rel="prefetch" href="/trainingdays/assets/js/33.e1098fb7.js"><link rel="prefetch" href="/trainingdays/assets/js/34.b6d29e40.js"><link rel="prefetch" href="/trainingdays/assets/js/35.4c61bb7b.js"><link rel="prefetch" href="/trainingdays/assets/js/36.336fcd60.js"><link rel="prefetch" href="/trainingdays/assets/js/37.772f2fe7.js"><link rel="prefetch" href="/trainingdays/assets/js/38.ba3ea198.js"><link rel="prefetch" href="/trainingdays/assets/js/39.52fb19ee.js"><link rel="prefetch" href="/trainingdays/assets/js/4.d015fbd5.js"><link rel="prefetch" href="/trainingdays/assets/js/40.354e399e.js"><link rel="prefetch" href="/trainingdays/assets/js/41.ec595a2b.js"><link rel="prefetch" href="/trainingdays/assets/js/42.48bed577.js"><link rel="prefetch" href="/trainingdays/assets/js/43.11938683.js"><link rel="prefetch" href="/trainingdays/assets/js/44.acddabd3.js"><link rel="prefetch" href="/trainingdays/assets/js/45.a2916451.js"><link rel="prefetch" href="/trainingdays/assets/js/46.95911633.js"><link rel="prefetch" href="/trainingdays/assets/js/47.c267ffc1.js"><link rel="prefetch" href="/trainingdays/assets/js/48.37cfbfe4.js"><link rel="prefetch" href="/trainingdays/assets/js/49.9fc08260.js"><link rel="prefetch" href="/trainingdays/assets/js/5.66f1ef82.js"><link rel="prefetch" href="/trainingdays/assets/js/50.f621e07d.js"><link rel="prefetch" href="/trainingdays/assets/js/51.e77f724a.js"><link rel="prefetch" href="/trainingdays/assets/js/52.c4e330aa.js"><link rel="prefetch" href="/trainingdays/assets/js/53.a6db7237.js"><link rel="prefetch" href="/trainingdays/assets/js/54.6d6dd706.js"><link rel="prefetch" href="/trainingdays/assets/js/55.de3427a7.js"><link rel="prefetch" href="/trainingdays/assets/js/56.357453fe.js"><link rel="prefetch" href="/trainingdays/assets/js/57.2b8c0b9b.js"><link rel="prefetch" href="/trainingdays/assets/js/58.34c86dce.js"><link rel="prefetch" href="/trainingdays/assets/js/59.20afb7e5.js"><link rel="prefetch" href="/trainingdays/assets/js/6.bd3d8f89.js"><link rel="prefetch" href="/trainingdays/assets/js/61.b7ff488e.js"><link rel="prefetch" href="/trainingdays/assets/js/62.2451e01f.js"><link rel="prefetch" href="/trainingdays/assets/js/63.d86a5b86.js"><link rel="prefetch" href="/trainingdays/assets/js/64.608921b5.js"><link rel="prefetch" href="/trainingdays/assets/js/65.d90b3114.js"><link rel="prefetch" href="/trainingdays/assets/js/66.49c6fbd9.js"><link rel="prefetch" href="/trainingdays/assets/js/67.4f60f26b.js"><link rel="prefetch" href="/trainingdays/assets/js/68.208402a2.js"><link rel="prefetch" href="/trainingdays/assets/js/69.a980b450.js"><link rel="prefetch" href="/trainingdays/assets/js/7.fc9a0f7c.js"><link rel="prefetch" href="/trainingdays/assets/js/70.cf4f53b8.js"><link rel="prefetch" href="/trainingdays/assets/js/71.55c061b2.js"><link rel="prefetch" href="/trainingdays/assets/js/72.7cc4b8ba.js"><link rel="prefetch" href="/trainingdays/assets/js/73.71f272fd.js"><link rel="prefetch" href="/trainingdays/assets/js/74.d9324332.js"><link rel="prefetch" href="/trainingdays/assets/js/75.22202aba.js"><link rel="prefetch" href="/trainingdays/assets/js/76.79e1fda3.js"><link rel="prefetch" href="/trainingdays/assets/js/77.09f6ecf5.js"><link rel="prefetch" href="/trainingdays/assets/js/78.40383fd1.js"><link rel="prefetch" href="/trainingdays/assets/js/79.c5447221.js"><link rel="prefetch" href="/trainingdays/assets/js/8.45342290.js"><link rel="prefetch" href="/trainingdays/assets/js/80.5cf25ae5.js"><link rel="prefetch" href="/trainingdays/assets/js/81.e3653e94.js"><link rel="prefetch" href="/trainingdays/assets/js/82.e34ef379.js"><link rel="prefetch" href="/trainingdays/assets/js/83.a86bfa1d.js"><link rel="prefetch" href="/trainingdays/assets/js/84.147161c7.js"><link rel="prefetch" href="/trainingdays/assets/js/85.ee46661f.js"><link rel="prefetch" href="/trainingdays/assets/js/86.b933c088.js"><link rel="prefetch" href="/trainingdays/assets/js/87.0b4539ef.js"><link rel="prefetch" href="/trainingdays/assets/js/9.235ee99d.js">
    <link rel="stylesheet" href="/trainingdays/assets/css/0.styles.68745622.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/trainingdays/" class="home-link router-link-active"><!----> <span class="site-name">Azure Developer College</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/azuredevcollege/trainingdays" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/azuredevcollege/trainingdays" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/trainingdays/" aria-current="page" class="sidebar-link">Home</a></li><li><a href="/trainingdays/day1/" class="sidebar-link">Day 1 Azure Fundamentals &amp; Infrastructure</a></li><li><a href="/trainingdays/day2/" aria-current="page" class="sidebar-link">Day 2 Azure Development</a></li><li><a href="/trainingdays/day3/" class="sidebar-link">Day 3 Data and AI</a></li><li><a href="/trainingdays/day4/" class="sidebar-link">Day 4 DevOps and Monitoring</a></li><li><a href="/trainingdays/day5/" class="sidebar-link">Day 5 Identity and Architecture</a></li><li><a href="/trainingdays/day6/" class="sidebar-link">Day 6 Containerization</a></li><li><a href="/trainingdays/day7/" class="sidebar-link">Day 7 Kubernetes</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="💎-breakout-4-optional-create-the-infrastructure-for-our-sample-app-with-arm-templates-💎"><a href="#💎-breakout-4-optional-create-the-infrastructure-for-our-sample-app-with-arm-templates-💎" class="header-anchor">#</a> 💎 Breakout 4 (optional): Create the infrastructure for our sample app with ARM templates 💎</h1> <p>⏲️ <em>Est. time to complete: 60 min.</em> ⏲️</p> <h2 id="here-is-what-you-will-learn-🎯"><a href="#here-is-what-you-will-learn-🎯" class="header-anchor">#</a> Here is what you will learn 🎯</h2> <p>So, this is our last Break-Out session for today. You will now have the challenge to create the <em>ARM template</em> for our SCM Contacts application and deploy it to Azure.</p> <h2 id="table-of-contents"><a href="#table-of-contents" class="header-anchor">#</a> Table Of Contents</h2> <ol><li><a href="#services">Services</a></li> <li><a href="#todo-for-you">ToDo for You</a></li> <li><a href="#references-links">References / Links</a></li> <li><a href="#wrap-up">Wrap-Up</a></li></ol> <h2 id="services"><a href="#services" class="header-anchor">#</a> Services</h2> <p>As a reminder, here is the architecture, we want to create:</p> <p><img src="/trainingdays/assets/img/architecture_day2.697228e8.png" alt="architecture_day2" title="architecture_day2"></p> <h3 id="services-to-be-added"><a href="#services-to-be-added" class="header-anchor">#</a> Services to be added</h3> <ul><li><strong>Contacts API</strong> <ul><li><em>Azure Web App:</em> <ul><li>Size: S1</li> <li>make it accept only HTTPS traffic</li></ul></li></ul></li> <li><strong>Resources / Images API</strong> <ul><li><em>Azure Storage Account:</em> <ul><li>SKU: Local Redundant Storage</li> <li>Kind: StorageV2</li></ul></li> <li><em>Azure Web App:</em> <ul><li>Size: S1</li> <li>make it accept only HTTPS traffic</li> <li>configure App Settings:
<ul><li>ImageStoreOptions__StorageAccountConnectionString: &lt;CONNECTIONSTRING_OF_STORAGEACCOUNT&gt;</li> <li>ImageStoreOptions__ImageContainer: <em>rawimages</em></li> <li>ImageStoreOptions-__ThumbnailContainer: <em>thumbnails</em></li> <li>StorageQueueOptions__StorageAccountConnectionString: &lt;CONNECTIONSTRING_OF_STORAGEACCOUNT&gt;</li> <li>StorageQueueOptions__Queue: <em>thumbnails</em></li> <li>StorageQueueOptions__ImageContainer: <em>rawimages</em></li> <li>StorageQueueOptions__ThumbnailContainer: <em>thumbnails</em></li></ul></li></ul></li> <li><em>Azure Function:</em> <ul><li>Consumption Plan (!)</li> <li>configure App Settings:
<ul><li>AzureWebJobsDashboard: &lt;CONNECTIONSTRING_OF_STORAGEACCOUNT&gt;</li> <li>AzureWebJobsStorage: &lt;CONNECTIONSTRING_OF_STORAGEACCOUNT&gt;</li> <li>StorageAccountConnectionString: &lt;CONNECTIONSTRING_OF_STORAGEACCOUNT&gt;</li> <li>QueueName: <em>thumbnails</em></li> <li>FUNCTIONS<em>WORKER_RUNTIME: _dotnet</em></li> <li>FUNCTIONS<em>EXTENSION_VERSION:</em>~2_</li> <li>ImageProcessorOptions__StorageAccountConnectionString: &lt;CONNECTIONSTRING_OF_STORAGEACCOUNT&gt;</li> <li>ImageProcessorOptions__ImageWidth: <em>100</em></li></ul></li></ul></li></ul></li> <li><strong>Frontend / Single Page Application</strong> <ul><li><em>Azure Storage Account:</em> <ul><li>SKU: Local Redundant Storage</li> <li>Kind: StorageV2</li> <li>Static Website Hosting can't be enabled via ARM templates at the time of writing. Enable it via Azure CLI after the deployment: <code>az storage blob service-properties update --account-name &lt;STORAGE_ACCOUNT_NAME&gt; --static-website --index-document index.html --404-document index.html</code>. To show the URL for it, use: <code>az storage account show -n &lt;STORAGE_ACCOUNT_NAME&gt; --query &quot;primaryEndpoints.web&quot; --output tsv</code></li></ul></li></ul></li></ul> <h2 id="todo-for-you"><a href="#todo-for-you" class="header-anchor">#</a> ToDo for You</h2> <p>Create one ARM template (plus parameters file) that contains all resources we need. Deploy the resources to a new resource group.</p> <h2 id="references-links"><a href="#references-links" class="header-anchor">#</a> References / Links</h2> <ul><li>You can access/see the current template/JSON of running resources via <a href="https://resources.azure.com" target="_blank" rel="noopener noreferrer">https://resources.azure.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. This is a good starting point, when you want to know what UI setting influences which JSON parameter.</li> <li>Azure Resource Manager Template Reference: <a href="https://docs.microsoft.com/azure/templates/" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/azure/templates/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>find documentation for all available properties of a service/resource</li></ul></li> <li>Azure Quickstart Templates: <a href="https://github.com/Azure/azure-quickstart-templates" target="_blank" rel="noopener noreferrer">https://github.com/Azure/azure-quickstart-templates<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>Azure Function App (Consumption Plan): <a href="https://github.com/Azure/azure-quickstart-templates/tree/master/101-function-app-create-dynamic" target="_blank" rel="noopener noreferrer">https://github.com/Azure/azure-quickstart-templates/tree/master/101-function-app-create-dynamic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Basic Web App: <a href="https://github.com/Azure/azure-quickstart-templates/tree/master/101-webapp-basic-windows" target="_blank" rel="noopener noreferrer">https://github.com/Azure/azure-quickstart-templates/tree/master/101-webapp-basic-windows<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Storage Account: <a href="https://github.com/Azure/azure-quickstart-templates/tree/master/101-storage-account-create" target="_blank" rel="noopener noreferrer">https://github.com/Azure/azure-quickstart-templates/tree/master/101-storage-account-create<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <h2 id="wrap-up"><a href="#wrap-up" class="header-anchor">#</a> Wrap-Up</h2> <p>🎉 <strong><em>Congratulations</em></strong> 🎉</p> <p>You have just automated the deployment of an Azure infrastructure. The next step would be to also automatically deploy the Web Apps / SPA to your infrastructure. We will learn about that on <a href="/trainingdays/day4/">Day 4</a>, when we are talking about <em>Continuous Integration and Continuous Deployment (CI/CD)</em>.</p> <p>On <a href="/trainingdays/day3/">Day 3</a>, we will learn about some additional Azure services that we can add to our application, to be able to store data, search for it and to show you how to do service-to-service communication with a <em>microservice approach</em>.</p> <p><a href="/trainingdays/day2/challenges/06-challenge-bo-3.html">◀ Previous challenge</a> | <a href="/trainingdays/day2/" class="router-link-active">🔼 Day 2</a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/azuredevcollege/trainingdays/edit/master/day2/challenges/07-challenge-bo-4.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/trainingdays/assets/js/app.cdb870d0.js" defer></script><script src="/trainingdays/assets/js/3.bac66e4c.js" defer></script><script src="/trainingdays/assets/js/60.cf52ab3d.js" defer></script>
  </body>
</html>
